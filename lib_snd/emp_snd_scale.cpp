//-----------------------------------------------------------------------------
// rgen.art
//-----------------------------------------------------------------------------
#include "emp_snd_scale.h"

//-----------------------------------------------------------------------------
//-----------------------------------------------------------------------------
// @@0 :remove
#include <cmath>

//-----------------------------------------------------------------------------
//-----------------------------------------------------------------------------
namespace emp { namespace snd {

//-----------------------------------------------------------------------------
//-----------------------------------------------------------------------------
//chromatic
//m_fOrigin = 440;
//m_fTones = 12;
//m_fRatio = 2;
//m_fOffset = 0;

//-----------------------------------------------------------------------------
//-----------------------------------------------------------------------------
EMP_RETURN bool scale_c::frequency(c_ui32 a_ui32Index, float& a_rfOut) const
{
    float const fOrigin = m_fOrigin;
    float const fTones = m_fTones;
    float const fRatio = m_fRatio;
    float const fOffset = m_fOffset + emp::ast::cast<float>(a_ui32Index);
    float const fNthRoot = powf(fRatio, 1 / fTones);
    float const fPitch = fOrigin * powf(fNthRoot, fOffset);
    a_rfOut = fPitch;
    return true;
}

//-----------------------------------------------------------------------------
//-----------------------------------------------------------------------------
} }

//-----------------------------------------------------------------------------
//-----------------------------------------------------------------------------

